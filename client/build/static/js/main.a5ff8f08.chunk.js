(this["webpackJsonpfrontend-react"]=this["webpackJsonpfrontend-react"]||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){},215:function(e,t,n){},216:function(e,t,n){},217:function(e,t,n){},218:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n.n(i),c=n(76),o=n.n(c),a=n(5),s=n(3),l=n(14),d=(n(85),n(86),n(6)),u=n.n(d),j=n(220),b={token:null,userId:null,login:function(e,t,n){},logout:function(){}},h=Object(i.createContext)(b),f=(n(97),n(0)),m=Object(s.g)((function(){var e=Object(i.useRef)(null),t=Object(i.useRef)(null),n=r.a.useState(!0),c=Object(a.a)(n,2),o=c[0],s=c[1],l=Object(i.useContext)(h);return Object(f.jsx)("div",{className:"main-content",children:Object(f.jsxs)("form",{className:"auth-form",onSubmit:function(n){var i,r;n.preventDefault(),e&&e.current&&e.current.focus(),t&&t.current&&t.current.focus();var c,a=null===(i=e.current)||void 0===i?void 0:i.value,d=null===(r=t.current)||void 0===r?void 0:r.value;/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a.toLowerCase())?(c={query:"\n        query Login($email: String!, $password: String!){\n          login(email: $email, password: $password) {\n            userId\n            token\n            tokenExpiration\n          }\n        }\n         ",variables:{email:a,password:d}},o||(c={query:"\n          mutation CreateUser($email: String!, $password: String!) {\n            createUser(userInput: {email: $email, password: $password}) {\n              _id\n              email\n            }\n          }\n        ",variables:{email:a,password:d}}),fetch("/graphql",{method:"POST",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!e.errors)return e.data.login?(l.login(e.data.login.token,e.data.login.userId,e.data.login.tokenExpiration),void u.a.fire({position:"top-end",icon:"success",title:e.data.login.userId+" Logged in Successfully",showConfirmButton:!1,timer:5e3})):e.data.createUser?(u.a.fire({position:"top-end",icon:"success",title:"Singed up Successfully",showConfirmButton:!1,timer:1200}),void s(!0)):void 0;u.a.fire({icon:"error",title:"Oops...",text:e.errors[0].message})})).catch((function(e){console.log(e)}))):u.a.fire({icon:"error",title:"Oops...",text:"Invalid email or password!"})},children:[Object(f.jsx)("h2",{children:"EventPlanner"}),Object(f.jsxs)(j.a,{border:"primary",className:"card",children:[Object(f.jsxs)("div",{className:"cardfooterparent",children:[Object(f.jsx)("div",{className:"cardfooter "+(o?"cardfooter2":""),children:Object(f.jsx)("button",{type:"button",onClick:function(){s(!0)},children:"LogIn"})}),Object(f.jsx)("div",{className:"cardfooter "+(o?"":"cardfooter2"),children:Object(f.jsx)("button",{type:"button",onClick:function(){s(!1)},children:"SignUp"})})]}),Object(f.jsxs)(j.a.Body,{children:[Object(f.jsxs)("div",{className:"form__group field",children:[Object(f.jsx)("input",{type:"input",ref:e,className:"form__field",placeholder:"Email",name:"email",id:"email",required:!0}),Object(f.jsx)("label",{htmlFor:"email",className:"form__label",children:"Email"})]}),Object(f.jsxs)("div",{className:"form__group field",children:[Object(f.jsx)("input",{type:"password",ref:t,className:"form__field",placeholder:"Password",name:"password",id:"password",required:!0}),Object(f.jsx)("label",{htmlFor:"password",className:"form__label",children:"Password"})]})]}),Object(f.jsx)(j.a.Footer,{children:Object(f.jsx)("div",{className:"form-actions",children:Object(f.jsx)("button",{type:"submit",children:"Submit"})})})]})]})})})),O=(n(103),function(){return Object(f.jsx)("div",{className:"spinner",children:Object(f.jsx)("div",{className:"lds-dual-ring"})})}),p=(n(104),function(e){var t=e.bookings.map((function(t){return Object(f.jsxs)("li",{className:"bookings__item",children:[Object(f.jsxs)("div",{className:"bookings__item-data",children:[t.event.title," -"," ",new Date(t.createdAt).toLocaleDateString()]}),Object(f.jsx)("div",{className:"bookings__item-actions",children:Object(f.jsx)("button",{onClick:e.onDelete.bind(undefined,t._id),children:"Cancel"})})]},t._id)}));return Object(f.jsxs)("div",{className:"bookings__list",children:[Object(f.jsx)("h2",{children:"Booked-Events!"}),Object(f.jsx)("ul",{children:t})]})}),v=n(80),x=function(e){var t={Cheap:0,Normal:0,Expensive:0};e.bookings.forEach((function(e){e.event.price<=100?t.Cheap=t.Cheap+1:e.event.price>100&&e.event.price<=200?t.Normal=t.Normal+1:t.Expensive=t.Expensive+1}));var n={labels:[],datasets:[]};n.labels.push("Cheap","Normal","Expensive"),n.datasets.push({label:"Events",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)"],borderWidth:2,data:[t.Cheap,t.Normal,t.Expensive]});return Object(f.jsx)("div",{className:"chart",children:Object(f.jsx)(v.a,{type:"bar",data:n,width:100,height:500,options:{maintainAspectRatio:!1,title:{display:!0,text:"Frequencies of Different Bookings based on Price",fontSize:25},layout:{padding:{left:175,right:175,bottom:100,top:0}},legend:{display:!0,position:"right",label:{fontColor:"#000"}}}})})},g=(n(210),void 0),_=function(e){return Object(f.jsxs)("div",{className:"bookings-control",children:[Object(f.jsx)("button",{className:"list"===e.activeOutputType?"active":"",onClick:e.onChange.bind(g,"list"),children:"List"}),Object(f.jsx)("button",{className:"chart"===e.activeOutputType?"active":"",onClick:e.onChange.bind(g,"chart"),children:"Chart"})]})},k=Object(s.g)((function(){var e=Object(i.useContext)(h),t=Object(i.useState)(!1),n=Object(a.a)(t,2),c=n[0],o=n[1],s=r.a.useState([]),l=Object(a.a)(s,2),d=l[0],j=l[1],b=Object(i.useState)("list"),m=Object(a.a)(b,2),v=m[0],g=m[1];Object(i.useEffect)((function(){var e=!0;return k(e),function(){e=!1}}),[]);var k=function(t){t&&o(!0);fetch("/graphql",{method:"POST",body:JSON.stringify({query:"\n          query {\n            bookings{\n              _id\n              createdAt\n              event {\n                _id\n                title\n                date\n                price\n              }\n            }\n          }\n        "}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.json()})).then((function(e){var n=e.data.bookings;t&&(j(n),o(!1))})).catch((function(e){t&&o(!1)}))},C=Object(f.jsx)(O,{});return c||(C=Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsx)(_,{activeOutputType:v,onChange:function(e){g("list"===e?"list":"chart")}}),Object(f.jsx)("div",{children:"list"===v?Object(f.jsx)(p,{bookings:d,onDelete:function(t){var n={query:"\n          mutation CancelBooking ($id: ID!) {\n            cancelBooking(bookingId: $id){\n              _id\n              title\n            }\n          }\n        ",variables:{id:t}};fetch("/graphql",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token}}).then((function(e){return e.json()})).then((function(e){if(e.errors)u.a.fire({icon:"error",title:"Oops...",text:e.errors[0].message});else{var n=d.filter((function(e){return e._id!==t}));j(n),u.a.fire("Cancelled!","Your Booking has been cancelled!","success")}})).catch((function(e){}))}}):Object(f.jsx)(x,{bookings:d})})]})),Object(f.jsx)("div",{className:"main-content",children:C})})),C=n(4),N=(n(211),n(212),function(e){return Object(f.jsxs)("div",{className:"modal",children:[Object(f.jsx)("header",{className:"modal__header",children:Object(f.jsx)("h1",{children:e.title})}),Object(f.jsx)("section",{className:"modal__content",children:e.children}),Object(f.jsxs)("section",{className:"modal__actions",children:[e.canCancel&&Object(f.jsx)("button",{onClick:e.onCancel,children:"Cancel"}),e.canConfirm&&Object(f.jsx)("button",{onClick:e.onConfirm,children:e.confirmText})]})]})}),y=(n(213),function(){return Object(f.jsx)("div",{className:"backdrop"})}),S=(n(214),function(e){return Object(f.jsxs)("li",{className:"events__list-items",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:e.title}),Object(f.jsxs)("h2",{children:["$",e.price," - ",new Date(e.date).toLocaleDateString()]})]}),Object(f.jsx)("div",{children:e.userId===e.creatorId?Object(f.jsx)("p",{children:"You are the owner of this event"}):Object(f.jsx)("button",{onClick:e.onDetail.bind(undefined,e.eventId),children:"View Details"})})]},e.eventId)}),w=(n(215),function(e){var t=e.events.map((function(t){return Object(f.jsx)(S,{eventId:t._id,title:t.title,price:t.price,date:t.date,creatorId:t.creator._id,userId:e.authUserId,onDetail:e.onViewDetail},t._id)}));return Object(f.jsx)("ul",{className:"event__list",children:t})}),E=Object(s.g)((function(){var e=Object(i.useContext)(h),t=r.a.useState([]),n=Object(a.a)(t,2),c=n[0],o=n[1],s=Object(i.useState)(!1),l=Object(a.a)(s,2),d=l[0],j=l[1],b=Object(i.useState)(null),m=Object(a.a)(b,2),p=m[0],v=m[1],x=r.a.useState(!1),g=Object(a.a)(x,2),_=g[0],k=g[1],S=Object(i.useRef)(null),E=Object(i.useRef)(null),I=Object(i.useRef)(null),$=Object(i.useRef)(null);Object(i.useEffect)((function(){var e=!0;return q(e),function(){e=!1}}),[]);var q=function(e){e&&j(!0);fetch("/graphql",{method:"POST",body:JSON.stringify({query:"\n          query {\n            events{\n              _id\n              title\n              description\n              date\n              price\n              creator {\n                _id\n              }\n            }\n          }\n        "}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.data.events;e&&(o(n),j(!1))})).catch((function(t){e&&j(!1)}))},T=function(){k(!1),v(null)};return Object(f.jsx)("div",{className:"main-content",children:Object(f.jsxs)(r.a.Fragment,{children:[e.token&&Object(f.jsxs)("div",{className:"events-control",children:[Object(f.jsx)("p",{children:"Share your own Events!!"}),Object(f.jsx)("button",{className:"btn",onClick:function(){k(!0)},children:"Create Event"})]}),(_||p)&&Object(f.jsx)(y,{}),_&&Object(f.jsx)(N,{title:"Add New Event",canCancel:!0,canConfirm:!0,onCancel:T,onConfirm:function(){var t,n,i,r;S&&S.current&&S.current.focus(),E&&E.current&&E.current.focus(),I&&I.current&&I.current.focus(),$&&$.current&&$.current.focus();var a=null===(t=S.current)||void 0===t?void 0:t.value,s=+(null===(n=E.current)||void 0===n?void 0:n.value),l=null===(i=I.current)||void 0===i?void 0:i.value,d=null===(r=$.current)||void 0===r?void 0:r.value;if(0===(null===a||void 0===a?void 0:a.trim().length)||s<=0||0===(null===l||void 0===l?void 0:l.trim().length)||0===(null===d||void 0===d?void 0:d.trim().length))u.a.fire({icon:"error",title:"Oops...",text:"Need to fill all fields or Price is worthless"});else{k(!1);var j={query:"\n          mutation CreateEvent($title: String!, $price: Float!, $date: String!, $description: String!) {\n            createEvent(eventInput: {title: $title, price: $price, date: $date, description: $description}){\n              _id\n              title\n              description\n              date\n              price\n            }\n          }\n        ",variables:{title:a,price:s,date:l,description:d}},b=e.token;fetch("/graphql",{method:"POST",body:JSON.stringify(j),headers:{Authorization:"Bearer "+b,"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){t.errors?u.a.fire({icon:"error",title:"Oops...",text:t.errors[0].message}):(o([].concat(Object(C.a)(c),[{_id:t.data.createEvent._id,title:t.data.createEvent.title,price:t.data.createEvent.price,description:t.data.createEvent.description,date:t.data.createEvent.date,creator:{_id:e.userId}}])),u.a.fire({position:"top-end",icon:"success",title:"Event Created Successfully",showConfirmButton:!1,timer:1200}))})).catch((function(e){console.log(e)}))}},confirmText:"Confirm",children:Object(f.jsxs)("form",{children:[Object(f.jsxs)("div",{className:"form__group field",children:[Object(f.jsx)("input",{type:"input",className:"form__field",ref:S,placeholder:"Title",name:"title",id:"title",required:!0}),Object(f.jsx)("label",{htmlFor:"title",className:"form__label",children:"Title"})]}),Object(f.jsxs)("div",{className:"form__group field",children:[Object(f.jsx)("input",{type:"number",min:"0",className:"form__field",ref:E,placeholder:"Price",name:"price",id:"price",required:!0}),Object(f.jsx)("label",{htmlFor:"price",className:"form__label",children:"Price"})]}),Object(f.jsxs)("div",{className:"form__group field",children:[Object(f.jsx)("input",{type:"datetime-local",className:"form__field",ref:I,placeholder:"Date",name:"date",id:"date",required:!0}),Object(f.jsx)("label",{htmlFor:"date",className:"form__label",children:"Date"})]}),Object(f.jsxs)("div",{className:"form-description",children:[Object(f.jsx)("label",{htmlFor:"description",children:"Description"}),Object(f.jsx)("br",{}),Object(f.jsx)("textarea",{id:"description",ref:$,rows:4,style:{width:"100%",resize:"vertical"}})]})]})}),p&&Object(f.jsxs)(N,{title:p.title,canCancel:!0,canConfirm:!0,onCancel:T,onConfirm:function(){if(!e.token)return v(null),void u.a.fire({icon:"error",title:"Oops...",text:"To Book an Event you must be logged in"});var t={query:"\n          mutation BookEvent($id: ID!) {\n            bookEvent(eventId: $id){\n              _id\n              createdAt\n              updatedAt\n            }\n          }\n        ",variables:{id:p._id}},n=e.token;fetch("/graphql",{method:"POST",body:JSON.stringify(t),headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.errors?u.a.fire({icon:"error",title:"Oops...",text:e.errors[0].message}):(v(null),u.a.fire({position:"top-end",icon:"success",title:"Selected Event booked Successfully",showConfirmButton:!1,timer:1200}))})).catch((function(e){console.log(e)}))},confirmText:"Book",children:[Object(f.jsx)("h1",{children:p.title}),Object(f.jsxs)("h2",{children:["$",p.price," -"," ",new Date(p.date).toLocaleDateString()]}),Object(f.jsx)("p",{children:p.description})]}),d?Object(f.jsx)(O,{}):Object(f.jsx)(w,{events:c,authUserId:e.userId,onViewDetail:function(e){var t=c.find((function(t){return t._id===e}));v(t)}})]})})})),I=(n(216),function(e){return Object(f.jsx)(h.Consumer,{children:function(e){return Object(f.jsxs)("header",{className:"main-navigation",children:[Object(f.jsx)("div",{className:"main-navigation__logo",children:Object(f.jsx)("h2",{children:"EventPlanner"})}),Object(f.jsx)("nav",{className:"main-navigation__items",children:Object(f.jsxs)("ul",{children:[!e.token&&Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/auth",children:"Authenticate"})}),Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/events",children:"Events"})}),e.token&&Object(f.jsxs)(r.a.Fragment,{children:[Object(f.jsx)("li",{children:Object(f.jsx)(l.b,{to:"/bookings",children:"Bookings"})}),Object(f.jsx)("li",{children:Object(f.jsx)("button",{onClick:e.logout,children:"Logout"})})]})]})})]})}})}),$=function(e){return Object(f.jsxs)(s.d,{children:[e.token&&Object(f.jsx)(s.a,{from:"/",to:"/events",exact:!0}),e.token&&Object(f.jsx)(s.a,{from:"/auth",to:"/events",exact:!0}),!e.token&&Object(f.jsx)(s.b,{exact:!0,path:"/auth",component:m}),Object(f.jsx)(s.b,{exact:!0,path:"/events",component:E}),e.token&&Object(f.jsx)(s.b,{exact:!0,path:"/bookings",component:k}),!e.token&&Object(f.jsx)(s.a,{to:"/auth",exact:!0})]})};var q=function(){var e=Object(i.useState)(null),t=Object(a.a)(e,2),n=t[0],r=t[1],c=Object(i.useState)(null),o=Object(a.a)(c,2),s=o[0],d=o[1];return Object(f.jsx)(l.a,{children:Object(f.jsxs)(h.Provider,{value:{token:n,userId:s,login:function(e,t,n){r(e),d(t)},logout:function(){r(null),d(null)}},children:[Object(f.jsx)(I,{}),Object(f.jsx)($,{token:n})]})})};n(217);o.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(q,{})}),document.getElementById("root"))},85:function(e,t,n){},86:function(e,t,n){}},[[218,1,2]]]);
//# sourceMappingURL=main.a5ff8f08.chunk.js.map